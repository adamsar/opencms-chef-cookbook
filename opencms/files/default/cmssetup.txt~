# Turn echo on
echo on

# Login the Admin user
login "Admin" "admin"

# Create the setup project
createTempfileProject

# Switch to the setup project
setCurrentProject "_setupProject"

# Initialize the default property definitions
createPropertyDefinition Title
createPropertyDefinition Description
createPropertyDefinition Keywords
createPropertyDefinition NavText
createPropertyDefinition NavPos
createPropertyDefinition export
createPropertyDefinition exportname
createPropertyDefinition default-file
createPropertyDefinition content-encoding
createPropertyDefinition content-conversion
createPropertyDefinition cache
createPropertyDefinition template
createPropertyDefinition template-elements
createPropertyDefinition locale
createPropertyDefinition config.sitemap

# Switch to the root context
setSiteRoot "/"

# Create folder structure
createFolder "/" "sites/"
createFolder "/sites/" "default/"
createFolder "/system/" "lost-found/"
createFolder "/system/" "modules/"
createFolder "/" "shared/"


# Apply folder permissions
chacc "/" "user" "ALL_OTHERS" "+v+r+i"
chacc "/" "role" "ROOT_ADMIN" "+v+w+r+c+d+i"
chacc "/system" "role" "WORKPLACE_USER" "+r+i"
chacc "/system/lost-found" "role" "WORKPLACE_MANAGER" "+v+w+r+c+d+i"
chacc "/system/modules" "role" "WORKPLACE_USER" "+v+r+i"
chacc "/system/orgunits" "role" "ACCOUNT_MANAGER" "+v+w+r+c+d+i"
chacc "/sites/default" "group" "Users" "+v+w+r+i"
chacc "/shared" "group" "Users" "+v+w+r+i" 

# Publish the project
unlockCurrentProject
publishProjectAndWait

# Create the default "Offline" project
createDefaultProject "Offline" "The Offline Project"

# Import the modules that have been selected in the setup wizard to the default site
setSiteRoot "/sites/default/"
importModule "packages/modules/org.opencms.workplace_8.5.2.zip"
importModule "packages/modules/org.opencms.workplace.administration_8.5.2.zip"
importModule "packages/modules/org.opencms.workplace.categories_8.5.0.zip"
importModule "packages/modules/org.opencms.workplace.explorer_8.5.2.zip"
importModule "packages/modules/org.opencms.workplace.galleries_8.5.0.zip"
importModule "packages/modules/org.opencms.workplace.handler_8.5.2.zip"
importModule "packages/modules/org.opencms.workplace.help_8.5.0.zip"
importModule "packages/modules/org.opencms.workplace.help.de_8.5.0.zip"
importModule "packages/modules/org.opencms.workplace.help.en_8.5.0.zip"
importModule "packages/modules/org.opencms.workplace.tools.accounts_8.5.2.zip"
importModule "packages/modules/org.opencms.workplace.tools.cache_8.5.0.zip"
importModule "packages/modules/org.opencms.workplace.tools.content_8.5.1.zip"
importModule "packages/modules/org.opencms.workplace.tools.database_8.5.0.zip"
importModule "packages/modules/org.opencms.workplace.tools.galleryoverview_8.5.0.zip"
importModule "packages/modules/org.opencms.workplace.tools.history_8.5.0.zip"
importModule "packages/modules/org.opencms.workplace.tools.link_8.5.0.zip"
importModule "packages/modules/org.opencms.workplace.tools.modules_8.5.0.zip"
importModule "packages/modules/org.opencms.workplace.tools.projects_8.5.2.zip"
importModule "packages/modules/org.opencms.workplace.tools.publishqueue_8.5.0.zip"
importModule "packages/modules/org.opencms.workplace.tools.scheduler_8.5.1.zip"
importModule "packages/modules/org.opencms.workplace.tools.searchindex_8.5.1.zip"
importModule "packages/modules/org.opencms.workplace.tools.workplace_8.5.2.zip"
importModule "packages/modules/org.opencms.editors_8.5.2.zip"
importModule "packages/modules/org.opencms.editors.codemirror_8.5.2.zip"
importModule "packages/modules/org.opencms.editors.editarea_8.5.0.zip"
importModule "packages/modules/org.opencms.editors.fckeditor_8.5.1.zip"
importModule "packages/modules/org.opencms.editors.tinymce_8.5.3.zip"
importModule "packages/modules/org.opencms.languagedetection_8.5.2.zip"
importModule "packages/modules/org.opencms.locale.de_8.5.2.zip"
importModule "packages/modules/org.opencms.locale.es_8.5.0.zip"
importModule "packages/modules/org.opencms.locale.it_8.5.0.zip"
importModule "packages/modules/org.opencms.locale.ja_8.5.2.zip"
importModule "packages/modules/org.opencms.locale.ru_8.5.0.zip"
importModule "packages/modules/org.opencms.jquery_8.5.2.zip"
importModule "packages/modules/org.opencms.gwt_8.5.2.zip"
importModule "packages/modules/org.opencms.ade.config_8.5.2.zip"
importModule "packages/modules/org.opencms.ade.containerpage_8.5.2.zip"
importModule "packages/modules/org.opencms.ade.contenteditor_8.5.2.zip"
importModule "packages/modules/org.opencms.ade.editprovider_8.5.2.zip"
importModule "packages/modules/org.opencms.ade.galleries_8.5.2.zip"
importModule "packages/modules/org.opencms.ade.postupload_8.5.2.zip"
importModule "packages/modules/org.opencms.ade.properties_8.5.2.zip"
importModule "packages/modules/org.opencms.ade.publish_8.5.2.zip"
importModule "packages/modules/org.opencms.ade.sitemap_8.5.2.zip"
importModule "packages/modules/org.opencms.ade.upload_8.5.2.zip"
importModulesFromSetupBean

# Rebuild search indexes
rebuildAllIndexes

exit
